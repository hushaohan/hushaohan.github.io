%!TEX root = cv.tex

\section{\sc Services}

\begin{luacode*}

local utils = require 'utils'

function render_services(services)
    local services_strs = {}
    for _, service in ipairs(services)
    do
        table.insert(services_strs, string.format(
            "\\begin{spacing}{.1}{\\href{%s}{\\textsc{%s}\\dotfill %s \\\\\\\\ \\scriptsize\\textsf{\\textcolor{gray}{~~%s}}}}\\\\\\end{spacing}",
            service.url,
            service.acronym,
            table.concat(utils.find_ranges(service.years), ', '),
            string.gsub(service.name, "&", "\\&")
        ))
    end
    return services_strs
end

tex.sprint([[{\bf Technical Program Committee}\vspace{-.22cm}]])
tex.sprint(table.concat(render_services(utils.load_db("../db/tpcs.json"))))

tex.sprint([[{\bf Conference Reviewer}\vspace{-.22cm}]])
tex.sprint(table.concat(render_services(utils.load_db("../db/conf-reviews.json"))))

tex.sprint([[{\bf Journal Reviewer}\vspace{-.22cm}]])
tex.sprint(table.concat(render_services(utils.load_db("../db/journal-reviews.json"))))

\end{luacode*}
